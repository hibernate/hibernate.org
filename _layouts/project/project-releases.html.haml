---
layout: project-standard
project_buttons_partial: project/releases-buttons.html.haml
---
-# Defines the project releases page template
-# Provide get started and download action buttons
-# List releases defined in the project metadata

-# subpages must define a section whose anchor is "supported-version"

-# Metadata from site.yml for the project
- project_description = site.projects[page.project]

.ui.icon.message
  %i.icon.doctor
  .content
    .header
      Interested in commercial support?
    %p
      Check out
      %a{:href => "/#{page.project}/support/"} Red Hat's offering
      \.

%h2 Series
- active_series = project_description.release_series.nil? ? nil : project_description.release_series.values.select{|s| s.displayed}
- unless active_series.nil? || active_series.empty?
  .ui.three.column.doubling.grid.series.active-series.stackable
    - active_series.each do |series|
      - release = series.releases[0]
      .column
        .ui.raised.segment.version
          %span{:class => "ui right ribbon label #{release.stable ? 'green' : 'orange'}"}
            #{release.stable ? 'stable' : 'development'}
          %h3.ui.header
            = series.version
            %small
              = release.date
          %p= series.summary
          .ui.right.aligned.basic.segment
            %a.ui.right.labeled.icon.button.primary{:href => "./#{series.version}/"}
              %i.right.arrow.icon
              More info
- else
  %p There are no releases configured for this project.

- older_series = project_description.release_series.nil? ? nil : project_description.release_series.values.select{|s| !s.displayed}
- unless older_series.nil? || older_series.empty?
  %p
    %a.ui.button.right.labeled.icon#older-series-button(href="javascript: void(0)")
      %i.icon.snowflake
      %span See older series
  :javascript
    $(document).ready(function() {
      $('#older-series-button').click(function() {
        $('#older-series').slideToggle(400, function() {
        });
        var buttonText = $('#older-series-button span');
        buttonText.text() == 'See older series' ?
          buttonText.text("Hide older series") :
          buttonText.text("See older series");
      });
    });

  #older-series
    %h2 Older series
    .ui.three.column.doubling.grid.series.older-series.stackable
      - older_series.each do |series|
        - release = series.releases[0]
        .column
          .ui.raised.segment.version
            %span{:class => "ui right ribbon label #{release.stable ? 'green' : 'orange'}"}
              #{release.stable ? 'stable' : 'development'}
            %h3.ui.header
              = series.version
              %small
                = release.date
            %p= series.summary
            .ui.right.aligned.basic.segment
              %a.ui.right.labeled.icon.button.primary{:href => "./#{series.version}/"}
                %i.right.arrow.icon
                More info

- unless project_description.integrations.nil?
  %h2#compatibility-matrix Compatibility matrix
  %table.ui.table.stackable.celled.striped
    %thead
      %tr
        %th
          = project_description.name
        - project_description.release_series.values.each do |series|
          - unless series.displayed then next end
          %th
            = series.version
    %tbody
      - project_description.integrations.each_pair do |integration_id, integration|
        %tr
          %td
            %a{:href => "#{integration['url']}"}
              = integration["name"]
          - project_description.release_series.values.each do |series|
            - unless series.displayed then next end
            - constraint = series.integration_constraints[integration_id]
            %td
              - if constraint == nil
                N/A
              - else
                #{constraint.version}
~ content

// Unfortunately, matchHeight doesn't follow the same convention as the other minified files
%script(src="#{site.match_height_js_url}#{site.minified ? '-min' : ''}.js")

:javascript
  $(document).ready(function() {
    $('.active-series .segment.version').matchHeight({ byRow: false });
    $('.older-series .segment.version').matchHeight({ byRow: false });
  });
